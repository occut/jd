<include file="Common/top"/>
<!--引用编辑器-->
<!-- Content Wrapper. Contains page content -->
<div class="layui-body" style="left:0;">
    <div class="content-wrapper" style = "margin-left:1px ;">
        <!-- Content Header (Page header) -->
        <section class="content-header">
            <h1>
                编辑任务
            </h1>
        </section>
        <!-- Main content -->
        <section class="content">
            <div style="margin-bottom: 20px">
                <a href="{:U('Tasks/Single')}" class="layui-btn ">做单任务审核</a>
                <a href="{:U('Tasks/flow')}" class="layui-btn ">流量任务审核</a>
            </div>
            <form class="layui-form" method="post" action="{:U('Tasks/edittimeTasks')}">
                <input type="hidden" value="{$result.task_id}" name="task_id">
                <div class="layui-form-item">
                    <label class="layui-form-label" style="width:150px;">SkuId</label>
                    <div class="layui-input-inline" style="width:300px;margin-left:0px;">
                        <input type="text" name="skuid" required  lay-verify="required" placeholder="" autocomplete="off" class="layui-input" value="{$result.skuid}">
                    </div>
                </div>
                <!--<div class="layui-form-item">-->
                    <!--<label class="layui-form-label" style="width:150px;">商品</label>-->
                    <!--<div class="layui-input-inline" style="width:300px;margin-left:0px;">-->
                        <!--<input type="text" name="product" required  lay-verify="required" placeholder="" autocomplete="off" class="layui-input" value="{$result.task_name}">-->
                    <!--</div>-->
                <!--</div>-->
                <div class="layui-form-item">
                    <label class="layui-form-label" style="width:150px;">件数</label>
                    <div class="layui-input-inline" style="width:300px;margin-left:0px;">
                        <input type="number" name="num" required  lay-verify="required" placeholder="下单商品件数" autocomplete="off" class="layui-input" value="{$result.num}">
                    </div>
                    <div class="layui-form-mid layui-word-aux">单个账号一次购买的商品件数</div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label" style="width:150px;">关键词</label>
                    <div class="layui-input-inline" style="width:300px;margin-left:0px;">
                        <input type="text" name="keyword" required  lay-verify="required" placeholder="此处只填写搜索商品关键词,如:电饭锅" autocomplete="off" class="layui-input" value="{$result.keyword}">
                    </div>
                </div>
                <!--<div class="layui-form-item">-->
                    <!--<label class="layui-form-label" style="width:150px;">所在页</label>-->
                    <!--<div class="layui-input-inline" style="width:300px;margin-left:0px;">-->
                        <!--<input type="number" name="page" required  lay-verify="required" placeholder="入口地址未搜索页时,请填写商品所在页数" autocomplete="off" class="layui-input" value="{$result.page}">-->
                    <!--</div>-->
                <!--</div>-->
                <div class="layui-form-item">
                    <label class="layui-form-label" style="width:150px;">描述</label>
                    <div class="layui-input-inline" style="width:300px;margin-left:0px;">
                        <textarea type="text" name="description" required  lay-verify="required" placeholder="" autocomplete="off" class="layui-input">{$result.description}</textarea>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label" style="width:150px;">订单数量</label>
                    <div class="layui-input-inline" style="width:300px;margin-left:0px;">
                        <input type="number" name="order_num" required  lay-verify="required" placeholder="购物车订单需要重复做的次数" autocomplete="off" class="layui-input order" value="{$result.order_num}" min="1" id="order_num">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"  style="width:150px;">任务类型</label>
                    <div class="layui-input-inline" style="width:300px;">
                        <select  name="task_type" lay-verify="required">
                            <option value="1" <if condition="$result.task_type eq 1">selected</if>>电脑单</option>
                            <option value="2" <if condition="$result.task_type eq 2">selected</if>>手机单</option>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"  style="width:150px;">店铺名</label>
                    <div class="layui-input-inline" style="width:300px;">
                        <select  name="shop" lay-verify="required">
                            <volist name="shop" id="vo">
                                <option value="{$vo.id}" <if condition="$result.shop eq $vo.id">selected</if>>{$vo.shop_name}</option>
                            </volist>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"  style="width:150px;">是否物流</label>
                    <div class="layui-input-block">
                        <input type="radio" name="transfer" value="0" title="不需要物流" lay-filter="transfer" <if condition="$result.transfer eq 0">checked</if>>
                        <input type="radio" name="transfer" value="1" title="需要物流" checked lay-filter="transfer" <if condition="$result.transfer eq 1">checked</if>>
                    </div>
                    <div class="layui-input-inline transfer pull-left" style="width:300px;margin-left:0px;" >
                        物流合计:<span></span>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label" style="width:150px;">订单金额</label>
                    <div class="layui-input-inline" style="width:300px;margin-left:0px;">
                        <input type="text" name="order_money"  placeholder="" autocomplete="off" class="layui-input order" value="{$result.order_money}" id="order_money">
                    </div>
                    <br/>
                    <div class="layui-input-block order_money" style="width:300px;margin-left:0px;" >
                        货款合计:<span></span>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"  style="width:150px;">是否空包</label>
                    <div class="layui-input-block">
                        <input type="radio" name="package" value="0" title="空包" <if condition="$result.package eq 0">checked</if>>
                        <input type="radio" name="package" value="1" title="非空包" <if condition="$result.package eq 1">checked</if>>
                    </div>
                </div>
                <!--<div class="layui-form-item">-->
                    <!--<label class="layui-form-label"  style="width:150px;">是否收藏</label>-->
                    <!--<div class="layui-input-block">-->
                        <!--<input type="radio" name="likes" value="0" title="收藏" <if condition="$result.likes eq 0">checked</if>>-->
                        <!--<input type="radio" name="likes" value="1" title="非收藏" <if condition="$result.likes eq 1">checked</if>>-->
                    <!--</div>-->
                <!--</div>-->
                <div class="layui-form-item">
                    <label class="layui-form-label" style="width:150px;">范围选择</label>
                    <div class="layui-input-inline" style="width:200px;margin-left:0px;">
                        <input class="layui-input" name="doTime" placeholder="执行时间" onclick="layui.laydate({elem: this, istime: true, format: 'YYYY-MM-DD hh:mm:ss'})" value="{$result.dotime}">
                    </div>
                    <!--<div class="layui-input-inline">-->
                    <!--<input class="layui-input" name="time[end]" placeholder="截止日" onclick="layui.laydate({elem: this, istime: true, format: 'YYYY-MM-DD hh:mm:ss'})">-->
                    <!--</div>-->
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label" style="width:150px;">买家备注</label>
                    <div class="layui-input-inline" style="width:300px;margin-left:0px;">
                        <input type="text" name="buyer_mark"  placeholder="" autocomplete="off" class="layui-input" value="{$result.buyer_mark}">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"  style="width:150px;">结算方式</label>
                    <div class="layui-input-block" id="payWay">
                        <input type="radio" name="payWay" value="0" title="预付" lay-filter="pay" <if condition="$result.payway eq 0">checked</if>>
                        <input type="radio" name="payWay" value="1" title="垫付" lay-filter="pay" <if condition="$result.payway eq 1">checked</if>>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label" style="width:150px;">佣金</label>
                    <div class="layui-input-inline" style="width:300px;margin-left:0px;" id="yongjing">
                        <input type="text" name="yongjing"  placeholder="" autocomplete="off" class="layui-input" readonly value="9" id="tips1" value="{$result.yongjing}">
                    </div>
                    <div class="layui-input-block yongjing" style="width:300px;margin-left:0px;" >
                        佣金合计:<span></span>
                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-input-block">
                        <button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
                        <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                    </div>
                </div>
            </form>

        </section>
    </div>
</div>
<include file="Common/button"/>
<script>
    $(function () {
        //    总货款
        $('.order').bind('input propertychange', function() {
            var orderNum=$("#order_num").val();
            var orderMoney=$("#order_money").val();
            var benjing=parseInt(orderNum)*parseFloat(orderMoney);
            $('.order_money span').text(benjing);
        });
    })

</script>
<script>
    //Demo
    layui.use('laydate', function(){
        var laydate = layui.laydate;
        var start = {
            min: laydate.now()
            ,max: '2099-06-16 23:59:59'
            ,istoday: false
            ,choose: function(datas){
                end.min = datas; //开始日选好后，重置结束日的最小日期
                end.start = datas //将结束日的初始值设定为开始日
            }
        };
        var end = {
            min: laydate.now()
            ,max: '2099-06-16 23:59:59'
            ,istoday: false
            ,choose: function(datas){
                start.max = datas; //结束日选好后，重置开始日的最大日期
            }
        };
    });
</script>
<script type="text/javascript">
    layui.use('form', function(){
        var form = layui.form;

        form.on('radio(transfer)', function(data){
            //有物流
            if (data.value==1){
                var wuliu=parseInt($("#order_num").val())*2.5;
                $(".transfer span").text(wuliu);
            }else{
                var wuliu=0;
                $(".transfer span").text(0);
            }
        });
        $('.order').bind('input propertychange', function() {
            var orderNum=parseFloat($("#order_num").val());
            var val=parseFloat($('#order_money').val());
            form.on('radio(pay)', function(data){
                if (data.value==1){
                    if (val<=200){
                        $(".yongjing span").text(10*orderNum);
                        $("#tips1").val(10);
                    }else if(val>200 && val<=500){
                        $(".yongjing span").text(11*orderNum);
                        $("#tips1").val(11);
                    }else if(val>500 && val<=1000){
                        $(".yongjing span").text(13*orderNum);
                        $("#tips1").val(13);
                    }else if(val>1000 && val<=1500){
                        $(".yongjing span").text(15*orderNum);
                        $("#tips1").val(15);
                    }else if(val>1500 && val<=2000){
                        $(".yongjing span").text(17*orderNum);
                        $("#tips1").val(17);
                    }else if(val>2000 && val<=2500){
                        $(".yongjing span").text(19*orderNum);
                        $("#tips1").val(19);
                    }else if(val>2500 && val<=3000){
                        $(".yongjing span").text(21*orderNum);
                        $("#tips1").val(21);
                    }else{
                        $(".yongjing span").text(val*0.008*orderNum);
                        $("#tips1").val(val*0.008);
                    }
                }
                else{
                    $(".yongjing span").text(9*orderNum);
                    $("#tips1").val(9);
                }
            });
        });

        form.on('select(province)', function(data){
            //            console.log(data.elem); //得到select原始DOM对象
            var id = data.value; //得到被选中的值
            //            console.log(data.othis); //得到美化后的DOM对象
            // alert(id);
            $.ajax({
                url:"{:U('Tasks/city')}",
                type:"post",
                dataType: "json",
                data:{'configId':id },
                async: "false",
                success:function(result){
                    // alert(123);
                    // alert(result.value);
                    $("#listAllConfigs").empty();
                    $("#listAllConfigs").append("<select style='display:block'   name='cityId' lay-verify='required'  class='layui-input'>"+result.value+"</select>");
                }

            })

        });
    });
</script>